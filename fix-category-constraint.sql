-- ============================================
-- ИСПРАВЛЕНИЕ: Удаление ограничения категорий
-- ============================================
-- Этот скрипт удаляет CHECK ограничение на поле category в таблице events,
-- которое блокирует использование новых категорий из таблицы event_categories
--
-- Выполните этот скрипт в Supabase Dashboard → SQL Editor
-- ============================================

-- Удаляем старое CHECK ограничение на категории, если оно существует
ALTER TABLE public.events 
DROP CONSTRAINT IF EXISTS events_category_check;

-- Проверяем, что ограничение удалено
-- (этот запрос должен вернуть пустой результат, если ограничение удалено)
SELECT 
    conname AS constraint_name,
    contype AS constraint_type
FROM pg_constraint
WHERE conrelid = 'public.events'::regclass
  AND conname = 'events_category_check';

-- ============================================
-- ГОТОВО!
-- ============================================
-- Теперь вы можете:
-- 1. Использовать любые категории из таблицы event_categories
-- 2. Обновлять категории существующих событий на новые категории
-- 3. Добавлять новые категории без ограничений
-- ============================================
